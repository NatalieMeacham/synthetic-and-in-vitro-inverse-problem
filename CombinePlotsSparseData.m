Bweightedsol100=[ 0.200000000000000   0.190206784431600   0.181874642589796   0.174804089531730   0.168828383609252   0.163796458113175   0.159573351665091   0.156046322924988   0.153130725260317...
   0.150751894060337   0.148840544913402   0.147333281580422   0.146173855042227   0.145315244868891   0.144718379625683   0.144349166139960   0.144176926181614   0.144174150415773...
   0.144316467554044   0.144582430081904   0.144953252273162   0.145412405749072   0.145945285620468   0.146539008180788   0.147182237184693   0.147865015261577   0.148578619380031...
   0.149315431180510   0.150068812228965   0.150832951219658   0.151602768340547   0.152373849814340   0.153142383070190   0.153905107302986   0.154659265011367   0.155402559746811...
   0.156133120707054   0.156849361180823   0.157549953925102   0.158233823203776   0.158900110127627   0.159548154220421   0.160177476325984   0.160787765925368   0.161378866710993...
   0.161950765612919   0.162503580216374   0.163037442046230   0.163552512333209   0.164049020226677   0.164527249014580   0.164987532045965   0.165430249114366   0.165855817816935...
   0.166264695797523   0.166657373665706   0.167034367395335   0.167396135107145   0.167743116362237   0.168075762040221   0.168394530722160   0.168699885402426   0.168992295018574...
   0.169272228823424   0.169540160401938   0.169796562714576   0.170041903285209   0.170276589567152   0.170501010058896   0.170715549842526   0.170920589186597   0.171116503221581...
   0.171303661367528   0.171482426294920   0.171653154746099   0.171816197049227   0.171971889949726   0.172120527866636   0.172262391708371   0.172397756684313   0.172526892203202...
   0.172650060650169   0.172767518793572   0.172879515675583   0.172986294475523   0.173088091570457   0.173185131315742   0.173277611118411   0.173365719957787   0.173449642081233...
   0.173529556766221   0.173605638159077   0.173678055503448   0.173746972537583   0.173812548177127   0.173874936011163   0.173934276720407   0.173990696719779   0.174044324373456...
   0.174095283044200]';

BSweightedsol100=[0.2      0.1902     0.18187      0.1748     0.16883      0.1638     0.15957     0.15605     0.15313     0.15075     0.14884     0.14733     0.14617     0.14532     0.14472     0.14435     0.14418     0.14417     0.14432     0.14458     0.14495     0.14541     0.14594     0.14654     0.14718     0.14786     0.14858     0.14931     0.15007     0.15083      0.1516     0.15237     0.15314     0.15391     0.15466      0.1554     0.15613     0.15685     0.15755     0.15823      0.1589     0.15955     0.16018     0.16079     0.16138     0.16195      0.1625     0.16304     0.16355     0.16405     0.16453     0.16499     0.16543     0.16586     0.16626     0.16666     0.16703      0.1674     0.16774     0.16808     0.16839      0.1687     0.16899     0.16927     0.16954      0.1698     0.17004     0.17028      0.1705     0.17072     0.17092     0.17112      0.1713     0.17148     0.17165     0.17182     0.17197     0.17212     0.17226      0.1724     0.17253     0.17265     0.17277     0.17288     0.17299     0.17309     0.17319     0.17328     0.17337     0.17345     0.17353     0.17361     0.17368     0.17375     0.17381     0.17387     0.17393     0.17399     0.17404     0.17409]';

Bsprobs100=[  6.0759e-08  1.9773e-07  6.1826e-07  1.8574e-06   5.361e-06  1.4867e-05  3.9613e-05  0.00010141  0.00024942  0.00058943   0.0013383   0.0029195    0.006119    0.012322    0.023841    0.044318    0.079155     0.13583     0.22395     0.35475     0.53991      0.7895      1.1092      1.4973      1.9419      2.4197      2.8969      3.3322      3.6827      3.9104      3.9894      3.9104      3.6827      3.3323       2.897      2.4199      1.9422      1.4978        1.11     0.79087     0.54211     0.35824      0.2294     0.14421    0.091836    0.063208     0.05154     0.05231    0.062954    0.082446     0.11089     0.14916     0.19862     0.26086     0.33748     0.42993     0.53924     0.66587     0.80949     0.96883      1.1416      1.3242      1.5123      1.7003      1.8821       2.051      2.2004      2.3241      2.4167       2.474      2.4934       2.474      2.4167      2.3241      2.2004       2.051      1.8821      1.7003      1.5123      1.3242      1.1416     0.96883     0.80948     0.66586     0.53923     0.42991     0.33744     0.26076     0.19837     0.14857     0.10955    0.079526    0.056835    0.039988    0.027699    0.018889    0.012682    0.008382   0.0054543   0.0034941   0.0022037]';

BoptweightfromAIC100=[ 0.00043758  0.00016495   0.0002718   0.0013307   0.0007925      0.0508    0.075039     0.19671     0.10954   0.0079229    0.031638    0.020061   0.0054488   0.0044045    0.057385    0.091994    0.099882    0.090564    0.071098    0.046247    0.019054   0.0021639   0.0018883   0.0062401   0.0089236]';

Bweightedsol25=[0.200000000000000  0.168134483589371  0.152503996584255  0.145823023612841  0.144160228383373  0.145233441521845  0.147692627775705   0.150738397150560   0.153905684336217...
   0.156938513367979  0.159707544440575  0.162160629887103   0.164290642823991   0.166113290757870  0.167657959582496   0.168956376459181   0.170042047465540...
   0.170945581448108  0.171694641544021   0.172313954240041   0.172824149908408   0.173243502679164   0.173586954021639   0.173867315869600   0.174095289819847]';

BSweightedsol25=[ 0.200000000000000   0.168132783413942   0.152503509897958   0.145827394566028   0.144158138303000   0.145231356774554   0.147692692895301   0.150738600967796   0.153907442691950...
   0.156939065862672  0.159707750688202   0.162159893320665   0.164289618914694   0.166112151005361   0.167657211576708   0.168956167479526   0.170042417866058   0.170946447238109...
   0.171695731937101  0.172315049319672   0.172824942942766   0.173243835760206   0.173586710295657   0.173866512608838   0.174094070315192]';

Bsprobs25=Bsprobs100;

BoptweightfromAIC25=[0   0.002961107997181   0.001420139940314   0.088907924306474   0.277568819125487   0.044488434281775   0.016695065059931   0.053181080716922...
   0.143399091572082  0.146966717439246   0.109765967752464   0.069107953427232   0.011476357118389   0.017063424131531   0.016997917130974]';

Bweightedsol10=[ 0.200000000000000   0.147341544228271   0.145947443593487   0.153905726419880   0.161379071317323   0.166657536714070   0.170042013002434   0.172120575237703   0.173365731311213   0.174095288412743]';

BSweightedsol10=[  0.200000000000000   0.147341630430514   0.145947278792946   0.153905719026185   0.161379213557225   0.166657332085964   0.170042237088759   0.172120939808482   0.173365514797774   0.174095081930952]';

Bsprobs10=Bsprobs100;

BoptweightfromAIC10=[  0.000599981608052   0.000832885125395   0.002588598565198   0.087921164894927   0.276365061140071   0.053567811121672   0.013595707528889   0.054476778602221...
   0.136076321046398   0.145953888278986   0.110428552511181   0.059605031340104   0.027725335866133   0.019180867892904   0.011082014477870]';




timestepplots(Bsprobs100,BoptweightfromAIC100,BoptweightfromAIC25,BoptweightfromAIC10,Bweightedsol100,Bweightedsol25,Bweightedsol10,BSweightedsol100,BSweightedsol25,BSweightedsol10)

function []=timestepplots(sprobs100,optweightfromAIC100,optweightfromAIC25,optweightfromAIC10,weightedsol100,weightedsol25,weightedsol10,Sweightedsol100,Sweightedsol25,Sweightedsol10)
points = 101;
sgrid=linspace(0,1,101);
cdfS100(1)=(1/101)*sprobs100(1);
    for i=2:points
        partialsumS=trapz(sgrid(1:i),sprobs100(1:i));
        cdfS100(i)=partialsumS;
    end

% figure
% plot(linspace(0,1,points),cdfS100,'r')
% hold on
% plot(linspace(0,1,length(optweightfromAIC100)), cumsum(optweightfromAIC100),'b')
% hold on
% plot(linspace(0,1,length(optweightfromAIC25)), cumsum(optweightfromAIC25),'b')
% ylim([0 1])

figure
stairs(linspace(0,1,length(optweightfromAIC100)),cumsum(optweightfromAIC100),'-','MarkerSize',8,'LineWidth',2,'Color','m')
hold on
stairs(linspace(0,1,length(optweightfromAIC25)),cumsum(optweightfromAIC25),'-','MarkerSize',8,'LineWidth',2,'Color','cyan')
hold on
stairs(linspace(0,1,length(optweightfromAIC10)),cumsum(optweightfromAIC10),'-','MarkerSize',8,'LineWidth',2,'Color','blue')
    ylim([0 1])
    hold on
    plot(linspace(0,1,points),cdfS100,'-','MarkerSize',6,'LineWidth',2,'Color','red')
    xlabel('Sensitivity to Treatment {\it s}')
%ylabel('Cumulative Recovered Prop. of Pop.') %original version
ylabel('Cumulative Recovered Proportion')
%legend(Legend, 'FontSize',12,'Location','northwest')
legend('Recovered, 100 Time Steps','Recovered, 25 Time Steps','Recovered, 10 Time Steps','Original','Location','Southeast')
set(gca,"FontSize",20)

figure
plot(linspace(0,50,100),weightedsol100,'md','LineWidth', 2,'MarkerSize',6)
hold on
plot(linspace(0,50,100),Sweightedsol100,'LineWidth',2,'Color','m')
hold on
plot(linspace(0,50,25),weightedsol25,'gd','LineWidth', 2,'MarkerSize',6)
hold on
plot(linspace(0,50,25),Sweightedsol25,'LineWidth',2,'Color','g')
hold on
plot(linspace(0,50,10),weightedsol10,'bd','LineWidth', 2,'MarkerSize',6)
hold on
plot(linspace(0,50,10),Sweightedsol10,'LineWidth',2,'Color','blue')
legend('Synthetic Data, 100 Time Steps','Recovered Curve, 100 Time Steps','Synthetic Data, 25 Time Steps','Recovered Curve, 25 Time Steps','Synthetic Data, 10 Time Steps','Recovered Curve, 10 Time Steps')
set(gca,"FontSize",20)
ylabel('Aggregated Tumor Volume')
xlabel('Time')

r100to25=length(optweightfromAIC25)/length(optweightfromAIC100);
r100to10=length(optweightfromAIC10)/length(optweightfromAIC100);

figure
yyaxis left
plot(linspace(0,1,length(optweightfromAIC100)),optweightfromAIC100,'LineWidth',2)
hold on
plot(linspace(0,1,length(optweightfromAIC25)),optweightfromAIC25*(r100to25),'LineWidth',2)
hold on
plot(linspace(0,1,length(optweightfromAIC10)),optweightfromAIC10*(r100to10),'LineWidth',2)
hold on
yyaxis right
plot(linspace(0,1,101),sprobs100,'LineWidth',2)
legend('100','25','10','Original')

end